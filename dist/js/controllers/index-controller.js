app.controller("IndexController",["$scope","$http","$window","$rootScope",function(a,o,s,e){a.teste="vinicius",a.validacao_email=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,a.nomevalidacao_somente_letras_com_caracter_especial=/^[A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ'\s]+$/,a.validacao_somente_letras=/^[a-zA-Z ]{1,25}$/,a.validacao_somente_numeros=/^[0-9]*$/,a.validacao_telefone=/^[0-9]{8,9}$/,a.pessoa={codigo:null,cpf_cnpj:"11015472788",nome:"Vinicius",email:null,telefone:null,residencial:null,cep:null,rua:null,numero_casa:null,bairro:null,complemento:null,cidade:null,uf:null},a.maskCPF=function(e){return e.substring(0,3)+"."+e.substring(3,6)+"."+e.substring(6,9)+"-"+e.substring(9,11)},a.maskCNPJ=function(e){return e.substring(0,2)+"."+e.substring(2,5)+"."+e.substring(5,8)+"/"+e.substring(8,12)+"-"+e.substring(12,14)},a.reset=function(){angular.copy({},a.pessoa),a.formulario.$setPristine(),a.formulario.$setUntouched()},a.criarCliente=function(){console.log(a.formulario)},a.validaCPF=function(e){for(var a=e.substr(0,9),o=e.substr(9,2),s=0,r=0;r<9;r++)s+=a.charAt(r)*(10-r);if(0==s)return!1;if(9<(s=11-s%11)&&(s=0),o.charAt(0)!=s)return!1;s*=2;for(r=0;r<9;r++)s+=a.charAt(r)*(11-r);return 9<(s=11-s%11)&&(s=0),o.charAt(1)==s},a.validaCNPJ=function(e){var a=new Array,o=new Number,s=[6,5,4,3,2,9,8,7,6,5,4,3,2];for(i=0;i<12;i++)a[i]=e.charAt(i),o+=a[i]*s[i+1];for((x=o%11)<2?a[12]=0:a[12]=11-x,o=0,y=0;y<13;y++)o+=a[y]*s[y];return(x=o%11)<2?a[13]=0:a[13]=11-x,e.charAt(12)==a[12]&&e.charAt(13)==a[13]},a.consultaCliente=function(e){cpf=e.pessoa.cpf_cnpj.replace(/\D/g,""),limparFormulario=function(){angular.copy({},a.pessoa)},o({method:"GET",url:"http://187.111.10.182:8998/ideia/core/pessoa/"+cpf,headers:{Accept:"text/html"}}).then(function(e){"message"in e.data?(console.log(e),s.alert("Nenhum dado encontrado")):(a.result=e.data.data.pessoa,angular.element(formulario.label).addClass("active"),a.pessoa.codigo=a.result[0].codigo,a.pessoa.nome=a.result[0].nome,a.pessoa.email=a.result[0].emailcontato,a.pessoa.telefone=a.result[0].telefone,a.pessoa.residencial=a.result[0].telefonecontato,a.pessoa.cep=a.result[0].enderecocep,a.pessoa.rua=a.result[0].endereco,a.pessoa.numero_casa=a.result[0].endereconumero,a.pessoa.complemento=a.result[0].enderecocomplemento,a.pessoa.bairro=a.result[0].enderecobairro,a.pessoa.cidade=a.result[0].cidade_nome,a.pessoa.uf=a.result[0].uf,console.log("Resultado: ",a.result))},function(e){s.alert("Serviço indisponível no momento"),console.log("Algo deu errado: ",e)})},a.validaCampoCpfCnpj=function(e){return valor=e.pessoa.cpf_cnpj.replace(/\D/g,""),tam=valor.length,11!=tam&&14!=tam?(a.formulario.cpf_cnpj.$setValidity("cpf_cnpj",!1),!1):11==tam?this.validaCPF(valor)?(a.formulario.cpf_cnpj.$setValidity("cpf_cnpj",!0),e.pessoa.cpf_cnpj=this.maskCPF(valor),!0):(a.formulario.cpf_cnpj.$setValidity("cpf_cnpj",!1),!1):14==tam?this.validaCNPJ(valor)?(a.formulario.cpf_cnpj.$setValidity("cpf_cnpj",!0),e.pessoa.cpf_cnpj=this.maskCNPJ(valor),!0):(a.formulario.cpf_cnpj.$setValidity("cpf_cnpj",!1),!1):void 0},a.consultaCep=function(e){if(cep=e.pessoa.cep,limparCamposEndereco=function(){a.pessoa.rua="",a.pessoa.bairro="",a.pessoa.cidade="",a.pessoa.uf=""},""!=cep){/^[0-9]{8}$/.test(cep)?(a.pessoa.rua="...",a.pessoa.bairro="...",a.pessoa.cidade="...",a.pessoa.uf="...",o({method:"GET",url:"https://viacep.com.br/ws/"+cep+"/json/?callback="}).then(function(e){"erro"in e.data?(limparCamposEndereco(),s.alert("Cep não encontrado.")):(a.pessoa.rua=e.data.logradouro,a.pessoa.bairro=e.data.bairro,a.pessoa.cidade=e.data.localidade,a.pessoa.uf=e.data.uf)},function(e){s.alert("O serviço de busca de CEP está indisponível no momento."),limparCamposEndereco()})):(limparCamposEndereco(),s.alert("Formato de CEP inválido"))}else limparCamposEndereco()}}]);